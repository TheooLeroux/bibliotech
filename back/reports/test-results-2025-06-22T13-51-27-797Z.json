{"numFailedTestSuites":1,"numFailedTests":2,"numPassedTestSuites":2,"numPassedTests":19,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":1,"numTotalTestSuites":3,"numTotalTests":22,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1750600288934,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["Database connectivity & schema"],"duration":32,"failing":false,"failureDetails":[{"matcherResult":{"actual":[{"tableName":"books","schema":"bibliotech"},{"tableName":"book_sub_genres","schema":"bibliotech"},{"tableName":"comments","schema":"bibliotech"},{"tableName":"favorites","schema":"bibliotech"},{"tableName":"main_genres","schema":"bibliotech"},{"tableName":"reading_history","schema":"bibliotech"},{"tableName":"reports","schema":"bibliotech"},{"tableName":"sub_genres","schema":"bibliotech"},{"tableName":"users","schema":"bibliotech"}],"expected":{"sample":["Users"],"inverse":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\nExpected: \u001b[32mArrayContaining [\"Users\"]\u001b[39m\nReceived: \u001b[31m[{\"schema\": \"bibliotech\", \"tableName\": \"books\"}, {\"schema\": \"bibliotech\", \"tableName\": \"book_sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"comments\"}, {\"schema\": \"bibliotech\", \"tableName\": \"favorites\"}, {\"schema\": \"bibliotech\", \"tableName\": \"main_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reading_history\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reports\"}, {\"schema\": \"bibliotech\", \"tableName\": \"sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"users\"}]\u001b[39m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\nExpected: \u001b[32mArrayContaining [\"Users\"]\u001b[39m\nReceived: \u001b[31m[{\"schema\": \"bibliotech\", \"tableName\": \"books\"}, {\"schema\": \"bibliotech\", \"tableName\": \"book_sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"comments\"}, {\"schema\": \"bibliotech\", \"tableName\": \"favorites\"}, {\"schema\": \"bibliotech\", \"tableName\": \"main_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reading_history\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reports\"}, {\"schema\": \"bibliotech\", \"tableName\": \"sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"users\"}]\u001b[39m\n    at Object.toEqual (C:\\xampp\\htdocs\\BiblioTech\\back\\tests\\01-db.test.js:11:24)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Database connectivity & schema doit se connecter à MariaDB et trouver la table Users","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1750600290083,"status":"failed","title":"doit se connecter à MariaDB et trouver la table Users"},{"ancestorTitles":["Database connectivity & schema"],"duration":30,"failing":false,"failureDetails":[{"matcherResult":{"actual":["ebooks"],"expected":{"sample":["users"],"inverse":false},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\nExpected: \u001b[32mArrayContaining [\"users\"]\u001b[39m\nReceived: \u001b[31m[\"ebooks\"]\u001b[39m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\nExpected: \u001b[32mArrayContaining [\"users\"]\u001b[39m\nReceived: \u001b[31m[\"ebooks\"]\u001b[39m\n    at Object.toEqual (C:\\xampp\\htdocs\\BiblioTech\\back\\tests\\01-db.test.js:21:23)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Database connectivity & schema doit se connecter à MongoDB et trouver la collection users","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600290118,"status":"failed","title":"doit se connecter à MongoDB et trouver la collection users"}],"endTime":1750600290162,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mDatabase connectivity & schema › doit se connecter à MariaDB et trouver la table Users\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    Expected: \u001b[32mArrayContaining [\"Users\"]\u001b[39m\n    Received: \u001b[31m[{\"schema\": \"bibliotech\", \"tableName\": \"books\"}, {\"schema\": \"bibliotech\", \"tableName\": \"book_sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"comments\"}, {\"schema\": \"bibliotech\", \"tableName\": \"favorites\"}, {\"schema\": \"bibliotech\", \"tableName\": \"main_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reading_history\"}, {\"schema\": \"bibliotech\", \"tableName\": \"reports\"}, {\"schema\": \"bibliotech\", \"tableName\": \"sub_genres\"}, {\"schema\": \"bibliotech\", \"tableName\": \"users\"}]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m  9 |\u001b[39m         \u001b[36mawait\u001b[39m expect(sequelize\u001b[33m.\u001b[39mauthenticate())\u001b[33m.\u001b[39mresolves\u001b[33m.\u001b[39mtoBeUndefined()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 10 |\u001b[39m         \u001b[36mconst\u001b[39m tables \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m sequelize\u001b[33m.\u001b[39mgetQueryInterface()\u001b[33m.\u001b[39mshowAllTables()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 11 |\u001b[39m         expect(tables)\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39marrayContaining([\u001b[32m'Users'\u001b[39m]))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                        \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 12 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 13 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 14 |\u001b[39m     it(\u001b[32m'doit se connecter à MongoDB et trouver la collection users'\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/01-db.test.js\u001b[39m\u001b[0m\u001b[2m:11:24)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mDatabase connectivity & schema › doit se connecter à MongoDB et trouver la collection users\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    Expected: \u001b[32mArrayContaining [\"users\"]\u001b[39m\n    Received: \u001b[31m[\"ebooks\"]\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 19 |\u001b[39m         \u001b[36mconst\u001b[39m colls \u001b[33m=\u001b[39m (\u001b[36mawait\u001b[39m mongoose\u001b[33m.\u001b[39mconnection\u001b[33m.\u001b[39mdb\u001b[33m.\u001b[39mlistCollections()\u001b[33m.\u001b[39mtoArray())\u001b[22m\n\u001b[2m     \u001b[90m 20 |\u001b[39m             \u001b[33m.\u001b[39mmap(c \u001b[33m=>\u001b[39m c\u001b[33m.\u001b[39mname)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 21 |\u001b[39m         expect(colls)\u001b[33m.\u001b[39mtoEqual(expect\u001b[33m.\u001b[39marrayContaining([\u001b[32m'users'\u001b[39m]))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 22 |\u001b[39m         \u001b[36mawait\u001b[39m mongoose\u001b[33m.\u001b[39mdisconnect()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 23 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 24 |\u001b[39m })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36mtests/01-db.test.js\u001b[39m\u001b[0m\u001b[2m:21:23)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\xampp\\htdocs\\BiblioTech\\back\\tests\\01-db.test.js","startTime":1750600288997,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["User Endpoints"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait laisser l'admin lister tous les utilisateurs","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600290907,"status":"passed","title":"devrait laisser l'admin lister tous les utilisateurs"},{"ancestorTitles":["User Endpoints"],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait refuser la liste des users à un non-admin","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600290914,"status":"passed","title":"devrait refuser la liste des users à un non-admin"},{"ancestorTitles":["User Endpoints"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait exiger une authentification pour /api/users","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600290924,"status":"passed","title":"devrait exiger une authentification pour /api/users"},{"ancestorTitles":["User Endpoints"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait permettre à un user de voir son propre profil","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600290928,"status":"passed","title":"devrait permettre à un user de voir son propre profil"},{"ancestorTitles":["User Endpoints"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints ne devrait pas permettre à un user de voir le profil d'un autre","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600290934,"status":"passed","title":"ne devrait pas permettre à un user de voir le profil d'un autre"},{"ancestorTitles":["User Endpoints"],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait laisser l'admin consulter n'importe quel profil","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1750600290941,"status":"passed","title":"devrait laisser l'admin consulter n'importe quel profil"},{"ancestorTitles":["User Endpoints"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait permettre à un user de mettre à jour son propre profil","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600290947,"status":"passed","title":"devrait permettre à un user de mettre à jour son propre profil"},{"ancestorTitles":["User Endpoints"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints ne devrait pas permettre à un user de modifier le profil d'un autre","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600290956,"status":"passed","title":"ne devrait pas permettre à un user de modifier le profil d'un autre"},{"ancestorTitles":["User Endpoints"],"duration":7,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait laisser l'admin modifier n'importe quel user","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600290961,"status":"passed","title":"devrait laisser l'admin modifier n'importe quel user"},{"ancestorTitles":["User Endpoints"],"duration":70,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints devrait laisser l'admin supprimer un utilisateur","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600290969,"status":"passed","title":"devrait laisser l'admin supprimer un utilisateur"},{"ancestorTitles":["User Endpoints"],"duration":3,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"User Endpoints ne devrait pas laisser un non-admin supprimer un utilisateur","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600291040,"status":"passed","title":"ne devrait pas laisser un non-admin supprimer un utilisateur"}],"endTime":1750600291046,"message":"","name":"C:\\xampp\\htdocs\\BiblioTech\\back\\tests\\03-user.test.js","startTime":1750600290172,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Auth Endpoints"],"duration":84,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints devrait enregistrer un nouvel utilisateur","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"startAt":1750600291355,"status":"passed","title":"devrait enregistrer un nouvel utilisateur"},{"ancestorTitles":["Auth Endpoints"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints ne devrait pas enregistrer un utilisateur si l’email existe déjà","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600291439,"status":"passed","title":"ne devrait pas enregistrer un utilisateur si l’email existe déjà"},{"ancestorTitles":["Auth Endpoints"],"duration":64,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints devrait connecter un utilisateur existant","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"startAt":1750600291444,"status":"passed","title":"devrait connecter un utilisateur existant"},{"ancestorTitles":["Auth Endpoints"],"duration":59,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints ne devrait pas connecter avec un mauvais mot de passe","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600291508,"status":"passed","title":"ne devrait pas connecter avec un mauvais mot de passe"},{"ancestorTitles":["Auth Endpoints"],"duration":8,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints doit renvoyer 400 si email ou mot de passe absent","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600291568,"status":"passed","title":"doit renvoyer 400 si email ou mot de passe absent"},{"ancestorTitles":["Auth Endpoints"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints devrait générer un lien de réinitialisation (forgot-password)","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"startAt":1750600291576,"status":"passed","title":"devrait générer un lien de réinitialisation (forgot-password)"},{"ancestorTitles":["Auth Endpoints"],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints devrait renvoyer 404 si l'email n'existe pas (forgot-password)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1750600291580,"status":"passed","title":"devrait renvoyer 404 si l'email n'existe pas (forgot-password)"},{"ancestorTitles":["Auth Endpoints"],"duration":5,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints ne devrait pas réinitialiser le mot de passe sans token valide","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1750600291584,"status":"passed","title":"ne devrait pas réinitialiser le mot de passe sans token valide"},{"ancestorTitles":["Auth Endpoints"],"duration":null,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"Auth Endpoints devrait réinitialiser le mot de passe avec un token valide","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1750600291589,"status":"todo","title":"devrait réinitialiser le mot de passe avec un token valide"}],"endTime":1750600291591,"message":"","name":"C:\\xampp\\htdocs\\BiblioTech\\back\\tests\\02-auth.test.js","startTime":1750600291050,"status":"passed","summary":""}],"wasInterrupted":false}
